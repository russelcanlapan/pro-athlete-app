    <script>
        let currentStep = 1;
        let userData = {
            profile: {
                firstName: '',
                lastName: '',
                email: '',
                password: '',
                userType: 'athlete'
            },
            onboarding: {
                birthday: '',
                height: '',
                weight: '',
                sport: '',
                teamType: '',
                position: ''
            }
        };

        // Initialize user data from session storage or use defaults
        function initializeUserData() {
            const savedData = sessionStorage.getItem('athleteUserData');
            if (savedData) {
                const existingData = JSON.parse(savedData);
                userData = { ...userData, ...existingData };
            }
        }

        // Save user data to session storage
        function saveUserData() {
            sessionStorage.setItem('athleteUserData', JSON.stringify(userData));
        }

        // Update user profile data
        function updateProfileData(field, value) {
            userData.profile[field] = value;
            saveUserData();
        }

        // Update onboarding data
        function updateOnboardingData(field, value) {
            userData.onboarding[field] = value;
            saveUserData();
        }

        function nextStep() {
            if (currentStep === 1) {
                // Validate first step
                const firstName = document.getElementById('firstName').value.trim();
                const lastName = document.getElementById('lastName').value.trim();
                const email = document.getElementById('email').value.trim();
                const password = document.getElementById('password').value;
                const confirmPassword = document.getElementById('confirmPassword').value;

                if (!firstName || !lastName || !email || !password) {
                    showError('Please fill in all fields.');
                    return;
                }

                if (password !== confirmPassword) {
                    showError('Passwords do not match.');
                    return;
                }

                if (password.length < 6) {
                    showError('Password must be at least 6 characters long.');
                    return;
                }

                // Save profile data
                updateProfileData('firstName', firstName);
                updateProfileData('lastName', lastName);
                updateProfileData('email', email);
                updateProfileData('password', password);

                // Show second step
                document.getElementById('step1').style.display = 'none';
                document.getElementById('step2').style.display = 'block';
                currentStep = 2;
                updateProgressBar();
            } else if (currentStep === 2) {
                // Validate second step
                const userType = document.querySelector('input[name="userType"]:checked');
                if (!userType) {
                    showError('Please select your user type.');
                    return;
                }

                // Save user type
                updateProfileData('userType', userType.value);

                // Navigate based on user type
                if (userType.value === 'athlete') {
                    window.location.href = '/onboarding/birthday.html';
                } else {
                    window.location.href = '/coaches/onboarding.html';
                }
            }
        }

        function prevStep() {
            if (currentStep === 2) {
                document.getElementById('step2').style.display = 'none';
                document.getElementById('step1').style.display = 'block';
                currentStep = 1;
                updateProgressBar();
            }
        }

        function updateProgressBar() {
            const progress = (currentStep / 2) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 3000);
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                nextStep();
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeUserData();
            
            // Pre-fill form with existing data if available
            if (userData.profile.firstName) {
                document.getElementById('firstName').value = userData.profile.firstName;
            }
            if (userData.profile.lastName) {
                document.getElementById('lastName').value = userData.profile.lastName;
            }
            if (userData.profile.email) {
                document.getElementById('email').value = userData.profile.email;
            }
            if (userData.profile.userType) {
                const radioButton = document.querySelector(`input[name="userType"][value="${userData.profile.userType}"]`);
                if (radioButton) {
                    radioButton.checked = true;
                }
            }
        });
    </script>
